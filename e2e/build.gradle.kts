/*
 * This file was generated by the Gradle 'init' task.
 *
 * This is a general purpose Gradle build.
 * To learn more about Gradle by exploring our Samples at https://docs.gradle.org/8.6/samples
 */

plugins {
    java
    id("io.spring.dependency-management") version "1.1.4"
    id("org.springframework.boot") version "3.2.3"
}

java {
    toolchain {
        languageVersion = JavaLanguageVersion.of(17)
    }
}

repositories {
    mavenCentral()
}

dependencies {
    testImplementation("org.assertj:assertj-core:3.25.3")

    testImplementation("org.springframework.boot:spring-boot-starter-data-jpa")
    testImplementation("io.cucumber:cucumber-java:7.15.0")
}

configurations {
    val cucumberRuntime: Configuration by configurations.creating {
        extendsFrom(configurations["testImplementation"])
    }
}

tasks.bootJar {
    enabled = false
}

task("cucumber") {
    dependsOn("assemble", "testClasses")
    doLast {
        javaexec {
            mainClass.set("io.cucumber.core.cli.Main")
            classpath = configurations["cucumberRuntime"] + sourceSets["main"].output + sourceSets["test"].output
            args = listOf("--plugin", "pretty",
                    "--glue", "cc.secondbrain.trade",
                    "src/test/resources")
        }
    }
}
